<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>EluVision</title>
  <!-- Import Styles -->
  <link rel="stylesheet" href="./styles.css" />
  <!-- Import Vue.js -->
  <script src="https://unpkg.com/vue@3.0.11/dist/vue.global.js"></script>
  <script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <div id="app">
    <div class="nav-bar"></div>

    <search-bar @search-string-updated="updateSearchString"></search-bar>

    <div id="results-list" v-if="all_deputies && state == 'list'">
      <table v-if="filtered_list.length">
        <tr>
          <th @click="updateSortBy('nom_de_famille')">
            <span>Nom</span>
            <span class="sort-icon" v-if="sort_by=='nom_de_famille'">
              <svg v-if="ascending" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-down-alt" viewBox="0 0 16 16">
                <path d="M3.5 3.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 12.293zm4 .5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5"/>
              </svg>
              <svg v-else xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-up" viewBox="0 0 16 16">
                <path d="M3.5 12.5a.5.5 0 0 1-1 0V3.707L1.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.5.5 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L3.5 3.707zm3.5-9a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"/>
              </svg>
            </span>
          </th>
          <th @click="updateSortBy('prenom')">
            <span>Prénom</span>
            <span class="sort-icon" v-if="sort_by=='prenom'">
              <svg v-if="ascending" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-down-alt" viewBox="0 0 16 16">
                <path d="M3.5 3.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 12.293zm4 .5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5"/>
              </svg>
              <svg v-else xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-up" viewBox="0 0 16 16">
                <path d="M3.5 12.5a.5.5 0 0 1-1 0V3.707L1.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.5.5 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L3.5 3.707zm3.5-9a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"/>
              </svg>
            </span>
          </th>
          <th @click="updateSortBy('nom_circo')">
            <span>Circonscription</span>
            <span class="sort-icon" v-if="sort_by=='nom_circo'">
              <svg v-if="ascending" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-down-alt" viewBox="0 0 16 16">
                <path d="M3.5 3.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 12.293zm4 .5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5"/>
              </svg>
              <svg v-else xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-up" viewBox="0 0 16 16">
                <path d="M3.5 12.5a.5.5 0 0 1-1 0V3.707L1.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.5.5 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L3.5 3.707zm3.5-9a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"/>
              </svg>
            </span>
          </th>
          <th @click="updateSortBy('num_deptmt')">
            <span>Département</span>
            <span class="sort-icon" v-if="sort_by=='num_deptmt'">
              <svg v-if="ascending" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-down-alt" viewBox="0 0 16 16">
                <path d="M3.5 3.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 12.293zm4 .5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5"/>
              </svg>
              <svg v-else xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-up" viewBox="0 0 16 16">
                <path d="M3.5 12.5a.5.5 0 0 1-1 0V3.707L1.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.5.5 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L3.5 3.707zm3.5-9a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"/>
              </svg>
            </span>
          </th>
          <th @click="updateSortBy('groupe_sigle')">
            <span>Groupe</span>
            <span class="sort-icon" v-if="sort_by=='groupe_sigle'">
              <svg v-if="ascending" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-down-alt" viewBox="0 0 16 16">
                <path d="M3.5 3.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 12.293zm4 .5a.5.5 0 0 1 0-1h1a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h3a.5.5 0 0 1 0 1zm0 3a.5.5 0 0 1 0-1h5a.5.5 0 0 1 0 1zM7 12.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5"/>
              </svg>
              <svg v-else xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sort-up" viewBox="0 0 16 16">
                <path d="M3.5 12.5a.5.5 0 0 1-1 0V3.707L1.354 4.854a.5.5 0 1 1-.708-.708l2-1.999.007-.007a.5.5 0 0 1 .7.006l2 2a.5.5 0 1 1-.707.708L3.5 3.707zm3.5-9a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"/>
              </svg>
            </span>
          </th>
        </tr>
        <tr v-for="(deputy, index) in filtered_list" :key="index" @click="showDetails(index)">
          <td>{{ deputy.nom_de_famille }}</td>
          <td>{{ deputy.prenom }}</td>
          <td>{{ deputy.nom_circo }}</td>
          <td>{{ deputy.num_deptmt }}</td>
          <td>{{ deputy.groupe_sigle}}</td>
        </tr>
      </table>
      <p v-else>Aucun résultat ne correspond à votre recherche</p>
    </div>

    <div class="deputy-details" v-if="state == 'details'">

      <!-- <div class="deputy-card">
        <div class="picture-div">
          <img class="deputy-picture" :src="'https://nosdeputes.fr/depute/photo/' + deputy_details.slug + '/200'">
        </div>
        <div class="deputy-info">
          <h1 class="card-component">{{ (deputy_details.sexe == 'F' ? 'Mme ' : 'M. ') + deputy_details.nom }}</h1>
          <h2 class="card-component">{{ deputy_details.groupe.organisme }}</h2>
          <p class="card-component">{{ deputy_details.nom_circo }} ({{ deputy_details.num_circo }})</p>
        </div>
      </div> -->

      <div class="card mb-3" style="max-width: 540px;">
        <div class="row g-0">
          <div class="col-md-4">
            <img class="img-fluid rounded-start"
              :src="'https://nosdeputes.fr/depute/photo/' + deputy_details.slug + '/250'">
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h5 class="card-title">{{ (deputy_details.sexe == 'F' ? 'Mme ' : 'M. ') + deputy_details.nom }}</h5>
              <p class="card-text">{{ deputy_details.groupe.organisme }}</p>
              <p class="card-text"><small class="text-body-secondary">{{ deputy_details.nom_circo }} ({{
                  deputy_details.num_circo }})</small></p>
              <div class="external-links">
                <div class="personnal-website" v-if="deputy_details.urls.personnal_website">
                  <a :href="deputy_details.urls.personnal_website" target="_blank">
                    <img src="./assets/website_icon.png">
                  </a>
                </div>
                <div class="twitter" v-if="deputy_details.urls.twitter">
                  <a :href="deputy_details.urls.twitter" target="_blank">
                    <img src="./assets/twitter.3.ico">
                  </a>
                </div>
                <div class="facebook" v-if="deputy_details.urls.facebook">
                  <a :href="deputy_details.urls.facebook" target="_blank">
                    <img src="./assets/facebook_icon.png">
                  </a>
                </div>
                <div class="email" v-if="deputy_details.urls.email">
                  <a :href="'mailto: ' + deputy_details.urls.email" target="_blank">
                    <img src="./assets/inbox_email.png">
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- TODO: lien vers le profile assemblee nationale -->

      <div class="responsibilities">
        <h2>Responsabilités</h2>
        <div class="accordion" id="accordionExample">
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
                aria-expanded="true" aria-controls="collapseOne">
                Responsabilités parlementaires
              </button>
            </h2>
            <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <ul>
                  <li v-for="resp in deputy_details.responsabilites">
                    {{ resp.responsabilite.organisme }}
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Responsabilités extra-parlementaires
              </button>
            </h2>
            <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <ul>
                  <li v-for="resp in deputy_details.responsabilites_extra_parlementaires">
                    {{ resp.responsabilite.organisme }}
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                Groupes parlementaires
              </button>
            </h2>
            <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <ul>
                  <li v-for="resp in deputy_details.groupes_parlementaires">
                    {{ resp.responsabilite.organisme }}
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="addresses">
        <h2>Adresses</h2>
        <ul>
          <li v-for="address in deputy_details.adresses">
            <p>{{ address.adresse }}</p>
          </li>
        </ul>
      </div>
      <button @click="showList">Back</button>

    </div>

    <div id="deputy-details">
    </div>
  </div>

  <!-- Import App -->
  <script src="./main.js"></script>
  <script src="./components/SearchBar.js"></script>

  <!-- Mount App -->
  <script>
    const mountedApp = app.mount('#app')
  </script>

  <footer>
    <div class="mentions-legales">
      <p>Mentions légales</p>
    </div>
  </footer>
</body>

</html>